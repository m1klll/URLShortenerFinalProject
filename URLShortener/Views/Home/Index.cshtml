@{
    ViewData["Title"] = "Сокращение ссылок";
}

<div class="text-center" style="max-width: 600px; margin: 40px auto; padding: 20px; font-family: Arial, sans-serif;">
    <h1>Сократить ссылку</h1>

    <form asp-controller="Home" asp-action="ShortenURL" method="post">
        <div style="margin-bottom: 15px;">
            <label for="originalUrl" style="display: block; margin-bottom: 5px; font-weight: bold;">Ссылка:</label>
            <input 
                type="url" 
                id="originalUrl" 
                name="originalUrl" 
                placeholder="example.com или https://example.com" 
                required 
                style="width: 100%; padding: 10px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px;"
                oninvalid="this.setCustomValidity('Пожалуйста, введите корректную ссылку')"
                oninput="this.setCustomValidity('')" />
        </div>

        <!-- Отображение ошибок ModelState -->
        @if (ViewData.ModelState.TryGetValue("originalUrl", out var errors))
        {
            <div style="color: red; margin: 10px 0; text-align: left;">
                @foreach (var error in errors.Errors)
                {
                    <p style="margin: 5px 0;"><strong>⚠️</strong> @error.ErrorMessage</p>
                }
            </div>
        }

        <button 
            type="submit" 
            style="background-color: #007bff; color: white; padding: 10px 20px; font-size: 16px; border: none; border-radius: 4px; cursor: pointer;">
            Сократить
        </button>
    </form>

    <!-- Показ короткой ссылки -->
    @if (ViewBag.ShortUrl != null)
    {
        <div style="margin-top: 30px; padding: 15px; background-color: #e9f7ef; border-radius: 8px; border: 1px solid #d4edda;">
            <h3>Готово! Ваша короткая ссылка:</h3>
            <a href="@ViewBag.ShortUrl" target="_blank" style="font-size: 18px; color: #007bff; word-break: break-all;">
                @ViewBag.ShortUrl
            </a>
            <div style="margin-top: 10px;">
                <button 
                    onclick="copyToClipboard('@ViewBag.ShortUrl')"
                    style="background-color: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer;">
                    Копировать
                </button>
            </div>
        </div>
    }
</div>

<script>
    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(function () {
            alert("Ссылка скопирована: " + text);
        }, function () {
            alert("Не удалось скопировать");
        });
    }
</script>

<style>
    body {
        background-color: #f8f9fa;
    }
</style>